<template>
  <div class="flex flex-col items-center justify-center wrapper-page">
    <div>
      <svg
        t="1716186216601"
        class="icon"
        viewBox="0 0 1034 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="7965"
        width="200"
        height="200"
      >
        <path
          d="M916.879974 297.370726l1.264858 0L918.144833 178.107467c0-75.388006-59.061555-134.44608-134.453658-134.44608L279.901063 43.661387c-77.765222 0-145.983693 62.831002-145.983693 134.44608l0 119.264291 8.980903 0C53.968282 341.220454 18.59113 438.246195 18.59113 505.558323l0 201.534016c0 47.474278 24.289178 91.31264 59.908813 117.81632-0.647782 2.606387-1.028506 5.309952-1.028506 8.093286L77.471437 908.593574c0 18.87488 15.732941 34.59799 34.597376 34.59799l75.571189 0c10.839347 0 19.022029-4.102451 24.596173-10.286285 6.021427-5.562675 10.002227-13.646848 10.002227-24.311706l0-57.662281L841.36613 850.931293 841.36613 908.593574c0 18.87488 15.734989 34.59799 34.599424 34.59799l75.561979 0c10.887373 0 19.098726-4.135219 24.675021-10.360934 5.974323-5.563699 9.920307-13.620224 9.920307-24.237056l0-75.590606c0-3.410637-0.530125-6.71703-1.487974-9.851392 30.052659-25.74336 48.836198-67.339674 48.836198-116.058317L1033.471085 505.558287C1033.471078 446.082662 997.449216 343.120691 916.879974 297.370726zM203.113062 178.107494c0-36.747981 41.276723-65.253171 76.786893-65.253171l503.791213 0c36.592845 0 65.256858 28.662784 65.256858 65.253171l0 97.365538c-6.855373-0.7552-13.905203-1.166541-21.174067-1.166541L248.412641 274.306492c-16.05632 0-31.137382 1.315942-45.298483 3.752448L203.114158 178.107467zM779.751322 735.607706 272.31089 735.607706l0 46.130643L153.942259 781.738349c-34.620928 0-66.155315-35.587482-66.155315-74.645094L87.786944 505.558287c0-1.619866 4.369715-162.058957 160.624742-162.058957l579.362402 0c103.806362 0 136.500326 126.327194 136.500326 162.058957l0 201.534016c0 36.196352-19.144806 74.645094-54.622208 74.645094L779.751362 781.737398 779.751362 735.607754zM268.943053 426.883482c-65.131008 0-118.108672 52.976538-118.108672 118.093619 0 65.115034 52.977664 118.092595 118.108672 118.092595 65.120768 0 118.098432-52.977562 118.098432-118.092595C387.041485 479.860019 334.063821 426.883482 268.943053 426.883482zM268.943053 593.874739c-26.974413 0-48.912998-21.93664-48.912998-48.896614 0-26.963046 21.938586-48.90071 48.912998-48.90071 26.963149 0 48.901734 21.937664 48.901734 48.90071C317.844787 571.938099 295.906202 593.874739 268.943053 593.874739zM782.049792 426.883482c-62.843802 0-113.966182 51.117261-113.966182 113.947238 0 62.821786 51.122381 113.927782 113.966182 113.927782 62.833562 0 113.94263-51.105997 113.94263-113.927782C895.991398 478.001664 844.883354 426.883482 782.049792 426.883482zM782.049792 585.565491c-24.687206 0-44.769485-20.069069-44.769485-44.734874 0-24.670925 20.082176-44.753306 44.769485-44.753306 24.673997 0 44.745933 20.082381 44.745933 44.753306C826.794701 565.495398 806.723789 585.565491 782.049792 585.565491z"
          p-id="7966"
          fill="#1296db"
        />
      </svg>
    </div>
    <span class="text-6xl text-sky-300">Â¥{{ value }}</span>
    <div class="text-8xl text-sky-400">flowers</div>
  </div>
</template>

<script setup lang="ts">
import { computed, onMounted, ref, unref, watch, watchEffect } from "vue";
import { useCchTransition } from "./useCchTransition";

function formatNumber(num: number | string) {
  if (!num && num !== 0) {
    return "";
  }
  num = Number(num).toFixed(2);
  return num.toString().padStart(3, "0");
}
const startVal = 1;
const endVal = 998;
const source = ref(startVal);
let outputValue = useCchTransition(source);
const value = computed(() => formatNumber(unref(outputValue)));

watchEffect(() => {
  source.value = startVal;
});

watch([() => startVal, () => endVal], () => {
  start();
});

const emit = defineEmits(["onStarted", "onFinished"]);
function run() {
  outputValue = useCchTransition(source, {
    disabled: false,
    duration: 1220,
    onFinished: () => emit("onFinished"),
    onStarted: () => emit("onStarted"),
  });
}

function start() {
  run();
  source.value = endVal;
}

onMounted(() => {
  start();
});
</script>

<style scoped></style>
